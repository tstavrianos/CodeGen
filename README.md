### CodeGen 

Extracted from https://github.com/unforbidable/patcher , with some minor changes.

All credits belong to [unforbidable](https://github.com/unforbidable).